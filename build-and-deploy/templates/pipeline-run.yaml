apiVersion: tekton.dev/v1alpha1
kind: PipelineRun
metadata:
  namespace: {{ .Values.global.namespace }}
  name: pipeline-run-{{ .Values.global.uid }}
  annotations:
    kapp.k14s.io/change-rule: "upsert after upserting ci/resources"
spec:
  serviceAccount: docker
  pipelineRef:
    name: build-deploy-pipeline
  resources:
    - name: source-repo
      resourceRef:
        name: repository-{{ .Values.global.uid }}
    - name: docker-image
      resourceRef:
        name: image-{{ .Values.global.uid }}
